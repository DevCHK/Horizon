<!doctype html>
<title>Ampel-Dashboard</title>
<style>
body{font-family:system-ui,Arial,Helvetica,sans-serif;padding:20px}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
.card{padding:16px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.06)}
.lamp{width:36px;height:36px;border-radius:50%;display:inline-block;margin-right:8px}
.green{background: #16a34a}
.yellow{background: #f59e0b}
.red{background: #dc2626}
.unknown{background:#9ca3af}
</style>
</head>
<body>
<h1>Ampel-Dashboard</h1>
<p id="updated">lade Daten...</p>
<div class="grid">
<div class="card">
<h3>Zinskurve 10y-2y</h3>
<div id="spread"></div>
</div>
<div class="card">
<h3>VIX</h3>
<div id="vix"></div>
</div>
<div class="card">
<h3>High Yield Spread</h3>
<div id="hy"></div>
</div>
<div class="card">
<h3>Shiller CAPE</h3>
<div id="cape"></div>
</div>
</div>
<h2>Gesamtstatus: <span id="overall"></span></h2>


<script>
async function load(){
try{
const r = await fetch('data/data.json?t='+(Date.now()));
if(!r.ok) throw new Error('fetch failed')
const j = await r.json();
document.getElementById('updated').textContent = 'Letzte Aktualisierung (UTC): '+j.timestamp_utc;


function render(id, val, date, status){
const el = document.getElementById(id);
const lamp = document.createElement('span');
lamp.className = 'lamp '+(status || 'unknown');
const text = document.createElement('span');
text.textContent = (val===null||val===undefined)?'n.a.':val + ' (' + (date||'n.a.') + ')';
el.innerHTML = '';
el.appendChild(lamp);
el.appendChild(text);
}


render('spread', j.spread.value, j.spread.date, j.status.spread);
render('vix', j.vix.value, j.vix.date, j.status.vix);
render('hy', j.high_yield_bps.value, j.high_yield_bps.date, j.status.hy);
render('cape', j.shiller_cape.value, j.shiller_cape.date, j.status.cape);


const ov = document.getElementById('overall');
ov.textContent = j.status.overall.toUpperCase();
ov.style.padding = '4px 8px';
ov.style.borderRadius = '8px';
if(j.status.overall==='green') ov.style.background='#16a34a';
else if(j.status.overall==='yellow') ov.style.background='#f59e0b';
else if(j.status.overall==='red') ov.style.background='#dc2626';
else ov.style.background='#9ca3af';
}catch(e){
document.getElementById('updated').textContent = 'Fehler beim Laden der Daten';
console.error(e);
}
}
load();
</script>
</body>
</html>
